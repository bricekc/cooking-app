<div class="recipe-form-container">
  <!-- Header -->
  <div class="header">
    <button type="button" class="back-button" (click)="goBack()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path
          d="M15 18L9 12L15 6"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
    <h1 class="header-title">Retour aux recettes</h1>
  </div>

  <div class="content">
    <h2 class="form-title">
      {{ isEditMode ? "Modifier la recette" : "Ajouter une nouvelle recette" }}
    </h2>

    <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()">
      <!-- Informations de base -->
      <div class="form-section">
        <h3 class="section-title">Informations de base</h3>

        <div class="form-group">
          <label class="form-label">Nom de la recette *</label>
          <input
            type="text"
            class="form-input"
            placeholder="Ex: Pâtes Carbonara"
            formControlName="name"
          />
        </div>

        <div class="form-group">
          <label class="form-label">Catégorie *</label>
          <select class="form-select" formControlName="categoryId">
            <option value="" disabled>-- Choisir une catégorie --</option>
            <option value="1">japonais</option>
            <option value="2">italien</option>
            <option value="3">mexicain</option>
            <option value="4">indien</option>
            <option value="5">thaïlandais</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Description *</label>
          <textarea
            class="form-textarea"
            placeholder="Décrivez votre recette..."
            formControlName="description"
            rows="4"
          ></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">URL de l'image</label>
          <input
            type="text"
            class="form-input"
            placeholder="https://example.com/image.jpg"
            formControlName="imageURL"
          />
        </div>

        <div class="form-group">
          <label class="form-label">Difficulté</label>
          <select class="form-select" formControlName="difficulty">
            <option value="">-- Sélectionnez la difficulté --</option>
            <option value="Très Facile">Très Facile</option>
            <option value="Facile">Facile</option>
            <option value="Intermédiaire">Intermédiaire</option>
            <option value="Difficile">Difficile</option>
          </select>
        </div>

        <div class="form-group two-columns">
          <div>
            <label class="form-label">Temps de préparation</label>
            <input
              type="text"
              class="form-input"
              placeholder="Ex: 15 min, 1h"
              formControlName="prepTime"
            />
          </div>
          <div>
            <label class="form-label">Temps de cuisson</label>
            <input
              type="text"
              class="form-input"
              placeholder="Ex: 30 min"
              formControlName="cookTime"
            />
          </div>
        </div>
      </div>

      <!-- Ingrédients -->
      <div class="form-section">
        <div class="section-header">
          <h3 class="section-title">Ingrédients</h3>
          <button type="button" class="add-button" (click)="addIngredient()">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path
                d="M10 4V16M4 10H16"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              />
            </svg>
            Ajouter
          </button>
        </div>

        <div formArrayName="ingredients">
          <div
            *ngFor="let ingredient of ingredients.controls; let i = index"
            class="ingredient-row"
          >
            <div [formGroupName]="i" class="ingredient-fields">
              <select class="form-select ingredient-name" formControlName="id">
                <option value="">-- Choisir un ingrédient --</option>
                <option
                  *ngFor="let ing of availableIngredients"
                  [value]="ing.id"
                >
                  {{ ing.name }}
                </option>
              </select>
              <input
                type="text"
                class="form-input ingredient-quantity"
                placeholder="Quantité"
                formControlName="quantity"
              />
              <select
                class="form-select ingredient-unit"
                formControlName="unit"
              >
                <option value="">Unité</option>
                <option value="g">g (grammes)</option>
                <option value="kg">kg (kilogrammes)</option>
                <option value="ml">ml (millilitres)</option>
                <option value="l">L (litres)</option>
                <option value="cl">cl (centilitres)</option>
                <option value="cs">c. à soupe</option>
                <option value="cc">c. à café</option>
                <option value="piece">pièce(s)</option>
                <option value="pincee">pincée(s)</option>
                <option value="tasse">tasse(s)</option>
              </select>
            </div>
            <button
              type="button"
              class="remove-button"
              (click)="removeIngredient(i)"
              *ngIf="ingredients.length > 1"
            >
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path
                  d="M6 6L14 14M6 14L14 6"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
      <!-- Étapes -->
      <div class="form-section">
        <div class="section-header">
          <h3 class="section-title">Étapes de préparation</h3>
          <button type="button" class="add-button" (click)="addStep()">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path
                d="M10 4V16M4 10H16"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              />
            </svg>
            Ajouter
          </button>
        </div>

        <div formArrayName="steps">
          <div
            *ngFor="let step of steps.controls; let i = index"
            class="step-row"
          >
            <div [formGroupName]="i" class="step-content">
              <div class="step-number">{{ i + 1 }}</div>
              <textarea
                class="form-textarea step-description"
                placeholder="Décrivez l'étape..."
                formControlName="description"
                rows="3"
              ></textarea>
            </div>
            <button
              type="button"
              class="remove-button"
              (click)="removeStep(i)"
              *ngIf="steps.length > 1"
            >
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path
                  d="M6 6L14 14M6 14L14 6"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
      <!-- Actions -->
      <div class="form-actions">
        <button type="button" class="cancel-button" (click)="goBack()">
          Annuler
        </button>
        <button
          type="submit"
          class="submit-button"
          [disabled]="!recipeForm.valid"
        >
          {{
            isEditMode ? "Enregistrer les modifications" : "Créer la recette"
          }}
        </button>
      </div>
    </form>
  </div>
</div>
